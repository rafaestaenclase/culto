<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Botonera de Sonidos</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
    }

    body {
      height: 80vh;
      max-width: 600px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      background: #0f0f0f;
      color: #fff;
    }

    h2 {
      padding: 12px;
      margin-bottom: 10px;
      text-align: center;
      background: #181818;
      border-bottom: 1px solid #222;
    }

    .container {
      padding-bottom: 10px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 12px;
      padding: 0 10px;
    }

    button {
      aspect-ratio: 1 / 1;
      background: #222;
      border: none;
      border-radius: 12px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
      transition: 
        transform 0.1s,
        background 0.2s,
        box-shadow 0.2s;
    }

    button:active {
      transform: scale(0.96);
    }

    /* ðŸ”¥ BOTÃ“N ACTIVO */
    button.active {
      background: #ff9800;
      box-shadow: 0 0 12px rgba(255, 152, 0, 0.7);
      color: #000;
    }

    /* Diferenciamos mÃºsica */
    button.music.active {
      background: #4caf50;
      box-shadow: 0 0 14px rgba(76, 175, 80, 0.8);
      color: #000;
    }
  </style>
</head>

<body>

  <div class="container">
    <h2>Efectos</h2>
    <div id="effectsGrid" class="grid"></div>
  </div>

  <div class="container">
    <h2>MÃºsica</h2>
    <div id="musicGrid" class="grid"></div>
  </div>

  <script>
    /* ======================
       CONFIGURACIÃ“N
       ====================== */

    const FADE_TIME = 2000;
    const MAX_VOLUME = 1;
    const FADE_STEPS = 30;

    const effects = [
      { title: 'Agua', src: './efx/agua.mp3' },
      { title: 'Moviendo Piedra', src: './efx/moviendoPiedra.mp3' }
    ];

    const musicas = [
      { title: 'Fiesta', src: 'music/fiesta.mp3' },
      { title: 'Ãrabe', src: 'music/arabe.mp3' }
    ];

    /* ======================
       LÃ“GICA
       ====================== */

    const effectsGrid = document.getElementById('effectsGrid');
    const musicGrid = document.getElementById('musicGrid');

    let currentMusic = null;
    let currentMusicButton = null;

    function fadeOut(audio, callback) {
      if (!audio) return;

      let step = audio.volume / FADE_STEPS;
      let interval = FADE_TIME / FADE_STEPS;

      const fade = setInterval(() => {
        audio.volume = Math.max(0, audio.volume - step);

        if (audio.volume <= 0) {
          clearInterval(fade);
          audio.pause();
          audio.currentTime = 0;
          callback && callback();
        }
      }, interval);
    }

    function fadeIn(audio) {
      audio.volume = 0;
      audio.play();

      let step = MAX_VOLUME / FADE_STEPS;
      let interval = FADE_TIME / FADE_STEPS;

      const fade = setInterval(() => {
        audio.volume = Math.min(MAX_VOLUME, audio.volume + step);
        if (audio.volume >= MAX_VOLUME) clearInterval(fade);
      }, interval);
    }

    /* ðŸ”Š EFECTOS */
    function createEffectButton({ title, src }) {
      const btn = document.createElement('button');
      btn.textContent = title;

      btn.addEventListener('click', () => {
        const audio = new Audio(src);
        btn.classList.add('active');

        audio.play();

        audio.addEventListener('ended', () => {
          btn.classList.remove('active');
        });
      });

      return btn;
    }

    /* ðŸŽµ MÃšSICA */
    function createMusicButton({ title, src }) {
      const btn = document.createElement('button');
      btn.textContent = title;
      btn.classList.add('music');

      const audio = new Audio(src);
      audio.loop = true;

      btn.addEventListener('click', () => {
        if (currentMusic === audio) return;

        if (currentMusic) {
          fadeOut(currentMusic);
          currentMusicButton.classList.remove('active');
        }

        currentMusic = audio;
        currentMusicButton = btn;

        btn.classList.add('active');
        fadeIn(audio);
      });

      return btn;
    }

    effects.forEach(effect => {
      effectsGrid.appendChild(createEffectButton(effect));
    });

    musicas.forEach(musica => {
      musicGrid.appendChild(createMusicButton(musica));
    });
  </script>

</body>
</html>
